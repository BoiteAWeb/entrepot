/*! galerie - v1.0.0-beta1 - 2017-06-03 5:40:26 PM UTC - https://imathi.eu/tag/galerie */
window.wp=window.wp||{},window.galerie=window.galerie||_.extend({},_.pick(window.wp,"Backbone","template")),function(a){return"undefined"!=typeof galeriel10n&&(a(document).ready(function(){a("body").addClass("gallerie-install-php");var b=a(".plugin-install-php .wp-filter-search");a(b).removeClass("wp-filter-search").prop("id","gallerie-search").css({margin:0,width:"280px","font-size":"16px","font-weight":300,"line-height":1.5,padding:"3px 5px",height:"32px"}),a('#typeselector [value="tag"]').remove(),a("#the-list").css({"margin-top":"2em"})}),galerie.Views=galerie.Views||{},galerie.View=galerie.Backbone.View.extend({prepare:function(){return!_.isUndefined(this.model)&&_.isFunction(this.model.toJSON)?this.model.toJSON():{}}}),galerie.Views.Card=galerie.View.extend({className:"plugin-card",template:galerie.template("galerie-repository"),initialize:function(){var a,b=this.model.get("description"),c="",d=galeriel10n.defaultIcon;c=_.isUndefined(b[galeriel10n.locale])?b.en_US:b[galeriel10n.locale],a=this.model.get("author"),this.model.get("author_url")&&(a='<a href="'+this.model.get("author_url")+'">'+a+"</a>"),a=galeriel10n.byAuthor.replace("%s",a),this.model.get("icon")&&(d=this.model.get("icon")),this.model.set({presentation:c,icon:d,author:a},{silent:!0}),this.model.get("name")&&(this.el.className+=" plugin-card-"+this.model.get("slug")),this.$el.prop("id",this.model.get("id"))}}),galerie.Views.List=galerie.View.extend({initialize:function(){_.each(this.collection.models,function(a){this.displayRepository(a)},this),a("#gallerie-search").on("keyup input",_.bind(this.searchRepositories,this)),a("#typeselector").on("change",this.resetSearch)},displayRepository:function(a){this.views.add(new galerie.Views.Card({model:a}))},searchRepositories:function(b){var c=a("#typeselector").val(),d=a(b.currentTarget).val().toLowerCase();b.preventDefault(),d?_.each(this.collection.models,function(b){var e=a("#"+b.get("id"));"term"===c&&-1===b.get("name").toLowerCase().indexOf(d)&&-1===b.get("presentation").toLowerCase().indexOf(d)||"author"===c&&-1===b.get("author").toLowerCase().indexOf(d)?e.addClass("hide-if-js"):e.removeClass("hide-if-js")}):a("#the-list .plugin-card").removeClass("hide-if-js")},resetSearch:function(b){b.preventDefault(),a("#gallerie-search").val(""),a("#the-list .plugin-card").removeClass("hide-if-js")}}),galerie.App={init:function(b){this.views=new Backbone.Collection,this.repositories=new Backbone.Collection(b),this.list=new galerie.Views.List({el:a("#the-list"),collection:this.repositories}).render()}},void a.getJSON(galeriel10n.url,function(a){return!!a&&(a.sort(function(){return.5-Math.random()}),void galerie.App.init(a))}).fail(function(b){a("#the-list").append('<div id="message" class="error"><p>'+a.parseJSON(b.responseText)+"</p></div>")}))}(jQuery);